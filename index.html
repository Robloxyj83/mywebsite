<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser OS - ALETEOS with AI</title>
    
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* ===== RESET & VARIABLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        : root {
            --primary-dark: #0f0f1e;
            --secondary-dark: #1a1a2e;
            --tertiary-dark: #16213e;
            --accent-blue: #0f3460;
            --accent-purple: #7b2cbf;
            --accent-cyan: #00d4ff;
            --text-light: #ffffff;
            --text-gray: #b0b0b0;
            --shadow:  rgba(0, 0, 0, 0.4);
        }

        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height:  100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0f0f1e 0%, #16213e 50%, #0f0f1e 100%);
            background-attachment: fixed;
            overflow: hidden;
            color: var(--text-light);
        }

        /* ===== EFFET FLOU EN ARRI√àRE-PLAN ===== */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width:  100%;
            height: 100%;
            background: radial-gradient(circle at 20% 50%, rgba(123, 44, 191, 0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(0, 212, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        /* ===== CONTAINER PRINCIPAL ===== */
        .container {
            position: relative;
            z-index: 1;
            width: 100%;
            height:  100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* ===== PANNEAU PRINCIPAL ===== */
        .main-panel {
            background: rgba(26, 26, 46, 0.6);
            border:  1px solid rgba(255, 255, 255, 0.1);
            border-radius: 40px;
            backdrop-filter:  blur(20px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 1200px;
            padding: 60px 40px;
            margin-bottom: 120px;
            animation: slideUp 0.8s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform:  translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== HEADER ===== */
        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        . welcome-text {
            font-size: 28px;
            font-weight:  300;
            color: var(--text-light);
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .subtext {
            font-size: 20px;
            color: var(--text-gray);
            font-weight: 400;
        }

        /* ===== BARRE DE RECHERCHE AVEC IA ===== */
        . search-bar {
            position: relative;
            margin-bottom: 40px;
            display: flex;
            gap:  10px;
        }

        .search-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.08);
            border:  1.5px solid rgba(255, 255, 255, 0.15);
            border-radius: 30px;
            padding: 15px 25px;
            color: var(--text-light);
            font-size: 16px;
            outline: none;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .search-input:: placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .search-input:focus {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(0, 212, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
        }

        .search-btn {
            background: linear-gradient(135deg, #00d4ff 0%, #0f3460 100%);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(0, 212, 255, 0.3);
            color: var(--text-light);
        }

        .search-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(0, 212, 255, 0.5);
        }

        . search-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ===== SECTION R√âCENTS ===== */
        .recents-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 18px;
            color: var(--text-light);
            margin-bottom: 20px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        . recents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        /* ===== CARTES ===== */
        .card {
            position: relative;
            height: 120px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .card:: before {
            content: '';
            position: absolute;
            top: 0;
            left:  0;
            right: 0;
            bottom: 0;
            background: var(--gradient);
            opacity: 0;
            transition:  opacity 0.3s ease;
            z-index: 0;
        }

        .card:hover::before {
            opacity: 1;
        }

        .card-content {
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            gap: 15px;
            width: 100%;
            height: 100%;
            padding:  20px;
            color: var(--text-light);
            text-decoration: none;
        }

        .card-icon {
            font-size: 40px;
            flex-shrink: 0;
            width: 50px;
            text-align: center;
            color: var(--accent-cyan);
        }

        .card-text {
            display: flex;
            flex-direction: column;
        }

        .card-title {
            font-size: 16px;
            font-weight:  600;
            color: var(--text-light);
        }

        .card-desc {
            font-size: 12px;
            color: var(--text-gray);
        }

        . card: hover {
            transform: translateY(-8px);
            box-shadow:  0 15px 50px rgba(0, 212, 255, 0.2);
        }

        /* ===== APPLICATIONS GRID ===== */
        .apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .app-card {
            position: relative;
            height: 140px;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            cursor: pointer;
            overflow: hidden;
            transition: all 0.3s ease;
            backdrop-filter:  blur(15px);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .app-card:: before {
            content: '';
            position: absolute;
            top: 0;
            left:  0;
            right: 0;
            bottom: 0;
            background: var(--app-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 0;
        }

        .app-card:hover::before {
            opacity: 1;
        }

        .app-card-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: var(--text-light);
        }

        .app-icon {
            font-size: 48px;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent-cyan);
        }

        .app-name {
            font-size: 14px;
            font-weight: 600;
            text-align: center;
        }

        .app-card:hover {
            transform: translateY(-12px) scale(1.05);
            box-shadow: 0 20px 60px rgba(0, 212, 255, 0.25);
        }

        /* ===== BARRE DES T√ÇCHES ===== */
        .taskbar {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform:  translateX(-50%);
            background: rgba(26, 26, 46, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50px;
            backdrop-filter:  blur(20px);
            padding: 12px 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .taskbar-icon {
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            transition: all 0.3s ease;
            color: var(--text-light);
        }

        .taskbar-icon:hover {
            background: rgba(0, 212, 255, 0.2);
            border-color: rgba(0, 212, 255, 0.5);
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
        }

        .taskbar-icon.active {
            background: linear-gradient(135deg, #00d4ff 0%, #0f3460 100%);
            border-color: var(--accent-cyan);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.4);
        }

        /* ===== MODAL HISTORIQUE ===== */
        . history-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .history-modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        . history-content {
            background: rgba(26, 26, 46, 0.95);
            border:  1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            backdrop-filter: blur(20px);
            width: 100%;
            max-width: 600px;
            max-height: 80vh;
            padding: 40px;
            overflow-y: auto;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
            animation: slideUpModal 0.3s ease;
        }

        @keyframes slideUpModal {
            from {
                opacity: 0;
                transform:  translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .history-title {
            font-size:  24px;
            font-weight: 600;
            color: var(--text-light);
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius:  50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--text-light);
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.5);
            transform: rotate(90deg);
        }

        . history-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        . history-item {
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            animation: slideInLeft 0.3s ease backwards;
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform:  translateX(-20px);
            }
            to {
                opacity: 1;
                transform:  translateX(0);
            }
        }

        .history-item: hover {
            background: rgba(0, 212, 255, 0.1);
            border-color: rgba(0, 212, 255, 0.3);
        }

        .history-icon {
            font-size: 28px;
            flex-shrink: 0;
            width: 40px;
            text-align:  center;
            color: var(--accent-cyan);
        }

        .history-info {
            flex: 1;
        }

        .history-name {
            font-size: 14px;
            font-weight:  600;
            color: var(--text-light);
        }

        .history-time {
            font-size: 12px;
            color: var(--text-gray);
            margin-top: 4px;
        }

        .clear-history-btn {
            width: 100%;
            margin-top: 30px;
            padding: 12px 20px;
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid rgba(255, 0, 0, 0.3);
            border-radius: 15px;
            color: var(--text-light);
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        . clear-history-btn:hover {
            background: rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.5);
        }

        . empty-history {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-gray);
        }

        /* ===== MODAL IA ===== */
        .ai-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }

        .ai-modal. active {
            display: flex;
        }

        .ai-content {
            background: rgba(26, 26, 46, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            backdrop-filter: blur(20px);
            width: 100%;
            max-width: 700px;
            height: 600px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6);
            animation: slideUpModal 0.3s ease;
        }

        . ai-header {
            display:  flex;
            justify-content:  space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom:  1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-title {
            font-size: 22px;
            font-weight:  600;
            color: var(--text-light);
        }

        .ai-close {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius:  50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--text-light);
            transition:  all 0.3s ease;
        }

        .ai-close:hover {
            background:  rgba(255, 0, 0, 0.2);
            border-color: rgba(255, 0, 0, 0.5);
            transform: rotate(90deg);
        }

        .ai-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .ai-messages: :-webkit-scrollbar {
            width: 6px;
        }

        . ai-messages::-webkit-scrollbar-track {
            background:  transparent;
        }

        .ai-messages::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        . ai-messages::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .message {
            display: flex;
            gap: 10px;
            animation: slideInLeft 0.3s ease;
        }

        .message. user {
            justify-content: flex-end;
        }

        .message-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius:  15px;
            word-wrap: break-word;
        }

        .message. user .message-bubble {
            background: linear-gradient(135deg, #00d4ff 0%, #0f3460 100%);
            color: var(--text-light);
        }

        .message.ai . message-bubble {
            background:  rgba(255, 255, 255, 0.08);
            color: var(--text-light);
            border:  1px solid rgba(255, 255, 255, 0.1);
        }

        .ai-input-area {
            display: flex;
            gap: 10px;
        }

        .ai-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.08);
            border: 1.5px solid rgba(255, 255, 255, 0.15);
            border-radius: 25px;
            padding: 12px 20px;
            color: var(--text-light);
            font-size: 14px;
            outline: none;
            transition: all 0.3s ease;
        }

        .ai-input:: placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .ai-input:focus {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(0, 212, 255, 0.5);
            box-shadow: 0 0 20px rgba(0, 212, 255, 0.2);
        }

        .ai-send {
            background: linear-gradient(135deg, #00d4ff 0%, #0f3460 100%);
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            transition: all 0.3s ease;
            font-size: 18px;
        }

        . ai-send:hover {
            transform: scale(1.1);
        }

        .ai-send:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        . loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid var(--accent-cyan);
            border-radius:  50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .main-panel {
                padding: 40px 20px;
                margin-bottom: 100px;
            }

            . welcome-text {
                font-size: 22px;
            }

            . recents-grid {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px;
            }

            .apps-grid {
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 15px;
            }

            .history-content, .ai-content {
                max-width: 90%;
                max-height: 70vh;
            }

            .ai-content {
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="main-panel">
            <!-- HEADER -->
            <div class="header">
                <div class="welcome-text">Bienvenue, Abdelhamid</div>
                <div class="subtext">Comment je pourrais vous aider ?</div>
            </div>

            <!-- BARRE DE RECHERCHE AVEC IA -->
            <div class="search-bar">
                <input type="text" class="search-input" id="aiInput" placeholder="Comment je peut vous aider ?" />
                <button class="search-btn" id="aiBtn"><i class="fas fa-paper-plane"></i></button>
            </div>

            <!-- SECTION R√âCENTS -->
            <div class="recents-section">
                <div class="section-title">R√©cents</div>
                <div class="recents-grid" id="recentsGrid">
                    <!-- Les √©l√©ments cliqu√©s appara√Ætront ici -->
                </div>
            </div>

            <!-- APPLICATIONS -->
            <div class="section-title">Applications</div>
            <div class="apps-grid" id="appsGrid">
                <!-- Les applications seront g√©n√©r√©es en JavaScript -->
            </div>
        </div>
    </div>

    <!-- BARRE DES T√ÇCHES -->
    <div class="taskbar">
        <div class="taskbar-icon" id="historyBtn" title="Historique"><i class="fas fa-history"></i></div>
        <div class="taskbar-icon" title="Menu"><i class="fas fa-cog"></i></div>
        <div class="taskbar-icon" title="Notifications"><i class="fas fa-bell"></i></div>
    </div>

    <!-- MODAL HISTORIQUE -->
    <div class="history-modal" id="historyModal">
        <div class="history-content">
            <div class="history-header">
                <div class="history-title">Historique</div>
                <button class="close-btn" id="closeHistoryBtn"><i class="fas fa-times"></i></button>
            </div>
            <div class="history-list" id="historyList">
                <!-- L'historique s'affichera ici -->
            </div>
            <button class="clear-history-btn" id="clearHistoryBtn"><i class="fas fa-trash"></i> Effacer l'historique</button>
        </div>
    </div>

    <!-- MODAL IA -->
    <div class="ai-modal" id="aiModal">
        <div class="ai-content">
            <div class="ai-header">
                <div class="ai-title"><i class="fas fa-brain"></i> Assistant IA</div>
                <button class="ai-close" id="aiCloseBtn"><i class="fas fa-times"></i></button>
            </div>
            <div class="ai-messages" id="aiMessages">
                <div class="message ai">
                    <div class="message-bubble">Bonjour ! üëã Je suis votre assistant IA.  Comment puis-je vous aider ? </div>
                </div>
            </div>
            <div class="ai-input-area">
                <input type="text" class="ai-input" id="aiChatInput" placeholder="Posez votre question..." />
                <button class="ai-send" id="aiChatBtn"><i class="fas fa-arrow-right"></i></button>
            </div>
        </div>
    </div>

    <script>
        // ===== CONFIGURATION ===== 
        const API_URL = 'http://localhost:3000/api/chat';

        // ===== DONN√âES DES APPLICATIONS =====
        const apps = [
            {
                id: 'canva',
                name: 'Canva',
                icon:  '<i class="fas fa-paint-brush"></i>',
                gradient: 'linear-gradient(135deg, rgba(123, 44, 191, 0.3) 0%, rgba(0, 212, 255, 0.3) 100%)',
                desc: 'Design'
            },
            {
                id: 'meteo',
                name: 'M√©t√©o',
                icon: '<i class="fas fa-cloud-sun"></i>',
                gradient: 'linear-gradient(135deg, rgba(255, 100, 0, 0.3) 0%, rgba(0, 150, 0, 0.3) 100%)',
                desc: '7¬∞C'
            },
            {
                id: 'bing',
                name: 'Recherche',
                icon: '<i class="fas fa-search"></i>',
                gradient: 'linear-gradient(135deg, rgba(255, 100, 0, 0.3) 0%, rgba(0, 150, 0, 0.3) 100%)',
                desc: 'Bing'
            },
            {
                id: 'edge',
                name: 'Edge',
                icon: '<i class="fab fa-edge"></i>',
                gradient: 'linear-gradient(135deg, rgba(255, 100, 0, 0.3) 0%, rgba(0, 150, 0, 0.3) 100%)',
                desc: 'Navigateur'
            },
            {
                id: 'drive',
                name: 'Google Drive',
                icon: '<i class="fab fa-google-drive"></i>',
                gradient: 'linear-gradient(135deg, rgba(100, 200, 255, 0.3) 0%, rgba(0, 150, 150, 0.3) 100%)',
                desc: 'Stockage'
            },
            {
                id: 'spotify',
                name: 'Spotify',
                icon: '<i class="fab fa-spotify"></i>',
                gradient: 'linear-gradient(135deg, rgba(29, 185, 84, 0.3) 0%, rgba(100, 255, 100, 0.3) 100%)',
                desc: 'Musique'
            },
            {
                id: 'discord',
                name: 'Discord',
                icon: '<i class="fab fa-discord"></i>',
                gradient: 'linear-gradient(135deg, rgba(88, 101, 242, 0.3) 0%, rgba(150, 100, 255, 0.3) 100%)',
                desc: 'Chat'
            },
            {
                id: 'vscode',
                name: 'VS Code',
                icon: '<i class="fas fa-code"></i>',
                gradient: 'linear-gradient(135deg, rgba(29, 150, 216, 0.3) 0%, rgba(100, 200, 255, 0.3) 100%)',
                desc: 'Code'
            },
            {
                id: 'figma',
                name: 'Figma',
                icon:  '<i class="fab fa-figma"></i>',
                gradient: 'linear-gradient(135deg, rgba(162, 85, 255, 0.3) 0%, rgba(255, 100, 200, 0.3) 100%)',
                desc: 'Design'
            },
            {
                id: 'github',
                name: 'GitHub',
                icon: '<i class="fab fa-github"></i>',
                gradient: 'linear-gradient(135deg, rgba(88, 96, 105, 0.3) 0%, rgba(200, 200, 200, 0.3) 100%)',
                desc: 'Repository'
            },
            {
                id: 'notion',
                name: 'Notion',
                icon: '<i class="fas fa-database"></i>',
                gradient:  'linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(200, 200, 200, 0.3) 100%)',
                desc: 'Notes'
            },
            {
                id: 'youtube',
                name: 'YouTube',
                icon: '<i class="fab fa-youtube"></i>',
                gradient: 'linear-gradient(135deg, rgba(255, 0, 0, 0.3) 0%, rgba(200, 50, 50, 0.3) 100%)',
                desc: 'Vid√©os'
            }
        ];

        // ===== GESTION DE L'HISTORIQUE DES APPLICATIONS =====
        let history = JSON.parse(localStorage.getItem('appHistory')) || [];

        function addToHistory(app) {
            const timestamp = new Date();
            const historyItem = {
                id:  app.id,
                name: app.name,
                icon: app.icon,
                time: timestamp,
                timeString: timestamp.toLocaleTimeString('fr-FR', { hour: '2-digit', minute:  '2-digit' })
            };

            history.unshift(historyItem);

            if (history.length > 50) {
                history.pop();
            }

            localStorage.setItem('appHistory', JSON.stringify(history));
            updateRecents();
        }

        // ===== AFFICHAGE DES R√âCENTS =====
        function updateRecents() {
            const recentsGrid = document.getElementById('recentsGrid');
            recentsGrid.innerHTML = '';

            const uniqueApps = [];
            const seenIds = new Set();

            for (const item of history) {
                if (! seenIds.has(item. id) && uniqueApps.length < 4) {
                    uniqueApps.push(item);
                    seenIds.add(item.id);
                }
            }

            if (uniqueApps.length === 0) {
                recentsGrid.innerHTML = '<p style="color: var(--text-gray); grid-column: 1/-1;">Aucun r√©cent</p>';
                return;
            }

            uniqueApps. forEach(item => {
                const card = document.createElement('div');
                card.className = 'card';
                const app = apps.find(a => a.id === item.id);
                card.style.setProperty('--gradient', app.gradient);

                card.innerHTML = `
                    <a href="#" class="card-content" data-app-id="${item.id}">
                        <div class="card-icon">${item.icon}</div>
                        <div class="card-text">
                            <div class="card-title">${item.name}</div>
                            <div class="card-desc">${new Date(item.time).toLocaleTimeString('fr-FR', { hour: '2-digit', minute:  '2-digit' })}</div>
                        </div>
                    </a>
                `;

                recentsGrid.appendChild(card);

                card.querySelector('a').addEventListener('click', (e) => {
                    e. preventDefault();
                    const appId = e.currentTarget.getAttribute('data-app-id');
                    const app = apps.find(a => a.id === appId);
                    addToHistory(app);
                });
            });
        }

        // ===== G√âN√âRATION DES APPLICATIONS =====
        function initApps() {
            const appsGrid = document.getElementById('appsGrid');
            appsGrid.innerHTML = '';

            apps.forEach((app, index) => {
                const appCard = document.createElement('div');
                appCard.className = 'app-card';
                appCard.style.setProperty('--app-gradient', app.gradient);

                appCard.innerHTML = `
                    <a href="#" class="app-card-content" data-app-id="${app.id}">
                        <div class="app-icon">${app.icon}</div>
                        <div class="app-name">${app.name}</div>
                    </a>
                `;

                appsGrid.appendChild(appCard);

                appCard.querySelector('a').addEventListener('click', (e) => {
                    e. preventDefault();
                    const appId = e.currentTarget.getAttribute('data-app-id');
                    const appData = apps.find(a => a.id === appId);
                    addToHistory(appData);
                });
            });
        }

        // ===== GESTION DE L'HISTORIQUE MODAL =====
        const historyBtn = document.getElementById('historyBtn');
        const historyModal = document.getElementById('historyModal');
        const closeHistoryBtn = document.getElementById('closeHistoryBtn');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');

        historyBtn.addEventListener('click', () => {
            historyModal. classList.add('active');
            updateHistoryDisplay();
            historyBtn.classList.add('active');
        });

        closeHistoryBtn.addEventListener('click', () => {
            historyModal.classList.remove('active');
            historyBtn. classList.remove('active');
        });

        historyModal.addEventListener('click', (e) => {
            if (e.target === historyModal) {
                historyModal.classList.remove('active');
                historyBtn.classList.remove('active');
            }
        });

        clearHistoryBtn.addEventListener('click', () => {
            if (confirm('√ätes-vous s√ªr de vouloir effacer tout l\'historique ?')) {
                history = [];
                localStorage.setItem('appHistory', JSON.stringify(history));
                updateHistoryDisplay();
                updateRecents();
            }
        });

        function updateHistoryDisplay() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';

            if (history.length === 0) {
                historyList.innerHTML = '<div class="empty-history">Aucun historique</div>';
                return;
            }

            history.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.style.animationDelay = `${index * 0.05}s`;

                historyItem.innerHTML = `
                    <div class="history-icon">${item.icon}</div>
                    <div class="history-info">
                        <div class="history-name">${item.name}</div>
                        <div class="history-time">${item.timeString}</div>
                    </div>
                `;

                historyList.appendChild(historyItem);
            });
        }

        // ===== GESTION DE LA MODAL IA =====
        const aiModal = document.getElementById('aiModal');
        const aiBtn = document.getElementById('aiBtn');
        const aiInput = document.getElementById('aiInput');
        const aiCloseBtn = document.getElementById('aiCloseBtn');
        const aiMessages = document.getElementById('aiMessages');
        const aiChatInput = document.getElementById('aiChatInput');
        const aiChatBtn = document.getElementById('aiChatBtn');

        // Ouvrir la modale IA
        function openAIModal() {
            aiModal. classList.add('active');
        }

        // Fermer la modale IA
        function closeAIModal() {
            aiModal.classList.remove('active');
        }

        aiBtn.addEventListener('click', () => {
            const text = aiInput.value.trim();
            if (text) {
                openAIModal();
                sendMessage(text);
                aiInput.value = '';
            }
        });

        aiInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const text = aiInput.value.trim();
                if (text) {
                    openAIModal();
                    sendMessage(text);
                    aiInput.value = '';
                }
            }
        });

        aiCloseBtn.addEventListener('click', closeAIModal);

        aiModal.addEventListener('click', (e) => {
            if (e. target === aiModal) {
                closeAIModal();
            }
        });

        aiChatBtn.addEventListener('click', () => {
            const text = aiChatInput.value.trim();
            if (text) {
                sendMessage(text);
                aiChatInput.value = '';
            }
        });

        aiChatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                const text = aiChatInput.value.trim();
                if (text) {
                    sendMessage(text);
                    aiChatInput. value = '';
                }
            }
        });

        // ===== ENVOI DES MESSAGES √Ä L'IA =====
        async function sendMessage(userMessage) {
            // Ajouter le message utilisateur
            const userMessageDiv = document.createElement('div');
            userMessageDiv.className = 'message user';
            userMessageDiv.innerHTML = `<div class="message-bubble">${userMessage}</div>`;
            aiMessages.appendChild(userMessageDiv);
            aiMessages.scrollTop = aiMessages.scrollHeight;

            // Ajouter le spinner de chargement
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'message ai';
            loadingDiv.innerHTML = `<div class="message-bubble"><div class="loading-spinner"></div></div>`;
            aiMessages.appendChild(loadingDiv);
            aiMessages.scrollTop = aiMessages.scrollHeight;

            try {
                // Envoyer la requ√™te au backend
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type':  'application/json'
                    },
                    body: JSON.stringify({ message: userMessage })
                });

                if (!response.ok) {
                    throw new Error(`Erreur HTTP: ${response.status}`);
                }

                const data = await response.json();

                // Supprimer le spinner
                loadingDiv.remove();

                // Ajouter la r√©ponse de l'IA
                const aiMessageDiv = document.createElement('div');
                aiMessageDiv.className = 'message ai';
                aiMessageDiv.innerHTML = `<div class="message-bubble">${data.message}</div>`;
                aiMessages.appendChild(aiMessageDiv);
                aiMessages.scrollTop = aiMessages.scrollHeight;

            } catch (error) {
                console.error('Erreur:', error);
                loadingDiv. remove();

                const errorDiv = document.createElement('div');
                errorDiv.className = 'message ai';
                errorDiv.innerHTML = `<div class="message-bubble" style="color: #ff6b6b;">‚ùå Erreur:  Impossible de se connecter au serveur.  Assurez-vous que votre serveur Node.js est lanc√© sur http://localhost:3000</div>`;
                aiMessages.appendChild(errorDiv);
                aiMessages. scrollTop = aiMessages.scrollHeight;
            }
        }

        // ===== INITIALISATION =====
        initApps();
        updateRecents();
    </script>
</body>
</html>
